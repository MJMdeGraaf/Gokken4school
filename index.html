diff --git a/index.html b/index.html
index cf9124be9c8bc7102a54ff0452d3332a21b9e7b4..b2a7d0742200911b1e37fca846e1ce3dfe00adae 100644
--- a/index.html
+++ b/index.html
@@ -68,53 +68,131 @@
         cursor: pointer;
     }
 
     /* ============================ Music menu style ============================ */
     #musicMenu{
       position: fixed;
       right: 20px;
       bottom: 70px;
       width: 300px;
       background: rgba(0,0,0,0.92);
       color: white;
       padding: 15px;
       border-radius: 12px;
       display: none;
       z-index: 99999;
     }
 
     #musicMenuInner{
       text-align: center;
     }
 
     #musicMenu input[type=range]{
       width: 80%;
     }
 
+    /* ============================ Loot box styles ============================ */
+    #lootBoxSection{
+      background: radial-gradient(circle at top, #1f1b3a 0, #050515 60%, #020208 100%);
+      min-height: 100vh;
+      text-align: center;
+      padding: 24px;
+    }
+
+    .lootbox-stage{
+      display: flex;
+      flex-direction: column;
+      align-items: center;
+      gap: 14px;
+      margin-top: 20px;
+    }
+
+    .lootbox-card{
+      width: 220px;
+      height: 220px;
+      border-radius: 24px;
+      display: flex;
+      flex-direction: column;
+      align-items: center;
+      justify-content: center;
+      gap: 8px;
+      font-size: 22px;
+      font-weight: 700;
+      color: #041014;
+      box-shadow: 0 18px 35px rgba(0,0,0,0.6);
+      cursor: pointer;
+      position: relative;
+      transition: transform 0.2s ease, box-shadow 0.2s ease;
+    }
+
+    .lootbox-card:hover{
+      transform: translateY(-4px);
+      box-shadow: 0 24px 40px rgba(0,0,0,0.7);
+    }
+
+    .lootbox-card.disabled{
+      cursor: default;
+      opacity: 0.8;
+    }
+
+    .lootbox-icon{
+      font-size: 54px;
+    }
+
+    .lootbox-chances{
+      display: flex;
+      gap: 10px;
+    }
+
+    .chance-dot{
+      width: 32px;
+      height: 32px;
+      border-radius: 50%;
+      border: 2px solid rgba(255,255,255,0.7);
+      display: flex;
+      align-items: center;
+      justify-content: center;
+      color: #ffe48a;
+      font-size: 16px;
+      background: rgba(0,0,0,0.3);
+      transition: opacity 0.2s ease, filter 0.2s ease;
+    }
+
+    .chance-dot.used{
+      opacity: 0.3;
+      filter: grayscale(1);
+    }
+
+    .lootbox-level-1{ background: linear-gradient(140deg, #55f0ff, #1aa7c9); }
+    .lootbox-level-2{ background: linear-gradient(140deg, #63e28a, #2e9c58); }
+    .lootbox-level-3{ background: linear-gradient(140deg, #c3844b, #8b4d20); }
+    .lootbox-level-4{ background: linear-gradient(140deg, #d8dbe2, #8b8f9c); }
+    .lootbox-level-5{ background: linear-gradient(140deg, #ffe48a, #c79a1b); }
+
     /* ============================ Rest of page ============================ */
     body { margin:0; font-family: system-ui, sans-serif; background:#050515; color:#fff;}
-    #login, #dashboard, #blackjackSection, #pokerSection { display: none; padding: 20px; text-align:center; }
+    #login, #dashboard, #blackjackSection, #pokerSection, #lootBoxSection { display: none; padding: 20px; text-align:center; }
     #login { background: radial-gradient(circle at top, #551a8b 0, #050515 55%, #020208 100%); height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center; gap:8px; }
     #dashboard { background: radial-gradient(circle at top, #4c1d7f 0, #050515 55%, #020208 100%); min-height:100vh; }
     #dashboard h2, #login h2 { margin-bottom:10px; }
     button { padding: 10px 14px; margin: 6px; border-radius: 8px; border:none; cursor:pointer; background:#e21a4d; color:#fff; font-weight:600; }
     button:hover{ filter:brightness(1.05); }
     input { padding:8px 10px; border-radius:6px; border:1px solid #444; background:#111; color:#fff; }
 
     /* Blackjack sectie */
     #blackjackSection {
       height: 100vh;
       color: white;
       background:
         radial-gradient(circle at 20% 0%, rgba(255,255,255,0.08), transparent 55%),
         radial-gradient(circle at 80% 100%, rgba(255,255,255,0.04), transparent 55%),
         radial-gradient(circle at center, #1c7b52 0, #094432 55%, #031614 100%);
     }
 
     .table-container {
       position: relative;
       width: 90%;
       max-width: 900px;
       margin: 36px auto;
       height: 520px;
       perspective: 900px;
     }
@@ -250,67 +328,91 @@
       .table-container{ height:360px; }
       .card-pk{ width:56px; height:84px; }
     }
   </style>
 </head>
 <body>
 
   <!-- Globale credits overlay -->
   <div id="creditsDisplayGlobal">
     Credits: <span id="globalCredits">0</span>
   </div>
 
   <!-- Login / Account aanmaken -->
   <section id="login">
     <h2>Welkom! Maak een account of log in</h2>
     <input type="text" id="usernameInput" placeholder="Gebruikersnaam">
     <input type="password" id="passwordInput" placeholder="Wachtwoord">
     <button id="loginBtn">Login</button>
     <button id="createAccountBtn">Account aanmaken</button>
   </section>
 
   <!-- Dashboard -->
   <section id="dashboard">
     <h2>Welkom, <span id="displayName"></span></h2>
     <p>Credits: <span id="credits"></span></p>
+    <p>Lucky Coins: <span id="luckyCoins"></span> (<span id="luckyCoinProgress"></span>/500)</p>
     <button id="claimDailyBtn">Claim dagelijkse bonus</button><br>
     <button id="playBlackjackBtn">Speel Blackjack</button>
     <button id="playPokerBtn">Speel Poker</button>
+    <button id="openLuckyBoxBtn">Lucky Box</button>
+    <button id="openDeluxeBoxBtn">Deluxe Lucky Box</button>
+    <button id="openUltraBoxBtn">Ultra Deluxe Lucky Box</button>
     <button id="logoutBtn">Uitloggen</button>
     <button id="playHorseRaceBtn">üèá Paardenrace</button>
 
     <!-- Music control -->
     <div style="margin-top:12px;">
       <audio id="bgMusic" loop>
         <source src="https://cdn.pixabay.com/audio/2023/03/07/audio_2ea36d1deb.mp3" type="audio/mpeg">
         <source src="https://cdn.pixabay.com/audio/2023/03/15/audio_e3bbcbfce7.mp3" type="audio/mpeg">
         <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_8f17fc4b42.mp3" type="audio/mpeg">
       </audio>
       <button id="musicControl">üéµ Muziek</button>
     </div>
   </section>
 
+  <!-- Loot Boxes -->
+  <section id="lootBoxSection" style="display:none;">
+    <h2 id="lootBoxTitle">Lucky Box</h2>
+    <p id="lootBoxSubtitle">Klik op de box om te upgraden. Je hebt 3 kansen.</p>
+    <div class="lootbox-stage">
+      <div id="lootBoxCard" class="lootbox-card lootbox-level-1">
+        <div class="lootbox-icon">üéÅ</div>
+        <div>Reward level <span id="lootBoxLevel">1</span></div>
+      </div>
+      <div id="lootBoxChances" class="lootbox-chances">
+        <div class="chance-dot">‚òÖ</div>
+        <div class="chance-dot">‚òÖ</div>
+        <div class="chance-dot">‚òÖ</div>
+      </div>
+      <div id="lootBoxHint">Klik om te upgraden (12,5% kans per klik).</div>
+      <div id="lootBoxReward"></div>
+    </div>
+    <button id="backToMenuFromLoot">Terug naar menu</button>
+  </section>
+
   <!-- Blackjack -->
   <section id="blackjackSection">
     <h2>Blackjack</h2>
     <div>
       <label>Kies aantal bots:</label>
       <select id="botCount">
         <option value="0">0 bots</option>
         <option value="1">1 bot</option>
         <option value="2">2 bots</option>
         <option value="3">3 bots</option>
         <option value="4">4 bots</option>
         <option value="5">5 bots</option>
         <option value="6">6 bots</option>
       </select><br><br>
       <label>Inzet (credits):</label>
       <input type="number" id="betAmount" min="1" value="100">
       <button id="startGame">Start spel</button>
       <button id="backToMenu">Terug naar menu</button>
     </div>
     <div class="table-container">
       <div class="table" id="table">
         <!-- Stoelen + spelergebieden komen hier dynamisch -->
       </div>
     </div>
     <div id="controls">
@@ -456,63 +558,78 @@
   <script>
     /* ---------------------------
        Data & helpers
        --------------------------- */
     let users = {};
     let currentUser = null;
 
     function keyForName(name){ return name.trim().toLowerCase(); }
 
     async function loadUser(key){
       const snap = await db.ref('users/'+key).once('value');
       return snap.val() || null;
     }
     async function saveCurrentUser(){
       if(!currentUser || !currentUser.key) return;
       await db.ref('users/'+currentUser.key).set(currentUser);
     }
 
     /* ---------------------------
        UI refs
        --------------------------- */
     const loginSection = document.getElementById('login');
     const dashboard = document.getElementById('dashboard');
     const blackjackSection = document.getElementById('blackjackSection');
     const pokerSection = document.getElementById('pokerSection');
+    const lootBoxSection = document.getElementById('lootBoxSection');
     const backFromPokerBtn = document.getElementById('backFromPokerBtn');
 
     const usernameInput = document.getElementById('usernameInput');
     const passwordInput = document.getElementById('passwordInput');
     const loginBtn = document.getElementById('loginBtn');
     const createAccountBtn = document.getElementById('createAccountBtn');
     const displayName = document.getElementById('displayName');
     const creditsEl = document.getElementById('credits');
     const claimDailyBtn = document.getElementById('claimDailyBtn');
     const logoutBtn = document.getElementById('logoutBtn');
     const playBlackjackBtn = document.getElementById('playBlackjackBtn');
     const playPokerBtn = document.getElementById('playPokerBtn');
+    const openLuckyBoxBtn = document.getElementById('openLuckyBoxBtn');
+    const openDeluxeBoxBtn = document.getElementById('openDeluxeBoxBtn');
+    const openUltraBoxBtn = document.getElementById('openUltraBoxBtn');
     const openLeaderboardsBtn = document.getElementById('openLeaderboardsBtn');
+    const luckyCoinsEl = document.getElementById('luckyCoins');
+    const luckyCoinProgressEl = document.getElementById('luckyCoinProgress');
+
+    const lootBoxTitle = document.getElementById('lootBoxTitle');
+    const lootBoxSubtitle = document.getElementById('lootBoxSubtitle');
+    const lootBoxCard = document.getElementById('lootBoxCard');
+    const lootBoxLevel = document.getElementById('lootBoxLevel');
+    const lootBoxChances = document.getElementById('lootBoxChances');
+    const lootBoxHint = document.getElementById('lootBoxHint');
+    const lootBoxReward = document.getElementById('lootBoxReward');
+    const backToMenuFromLoot = document.getElementById('backToMenuFromLoot');
 
     const bgMusic = document.getElementById('bgMusic');
     const musicControl = document.getElementById('musicControl');
     const musicMenu = document.getElementById('musicMenu');
     const musicVolume = document.getElementById('musicVolume');
     const musicTrackSelect = document.getElementById('musicTrackSelect');
     const closeMusicMenu = document.getElementById('closeMusicMenu');
     const muteBtn = document.getElementById('muteBtn');
 
     /* Blackjack refs */
     const startGameBtn = document.getElementById('startGame');
     const botSelect = document.getElementById('botCount');
     const betAmountInput = document.getElementById('betAmount');
     const table = document.getElementById('table');
     const hitBtn = document.getElementById('hitBtn');
     const standBtn = document.getElementById('standBtn');
     const nextRoundBtn = document.getElementById('nextRoundBtn');
     const backToMenuBtn = document.getElementById('backToMenu');
 
     /* Poker refs */
     const pokerTableSelect = document.getElementById('pokerTableSelect');
     const joinPokerBtn = document.getElementById('joinPokerBtn');
     const leavePokerBtn = document.getElementById('leavePokerBtn');
     const pokerPotEl = document.getElementById('pokerPot');
     const pokerSidePotEl = document.getElementById('pokerSidePot');
@@ -528,154 +645,273 @@
     const lbTab = document.getElementById('lb-tab');
     const lbPopup = document.getElementById('lb-popup');
     const lbLeft = document.getElementById('lb-left');
     const lbRight = document.getElementById('lb-right');
     const lbClose = document.getElementById('lb-close');
     const lbTitle = document.getElementById('lb-title');
     const lbContent = document.getElementById('lb-content');
 
     const creditsGlobalSpan = document.getElementById('globalCredits');
 
     /* ---------------------------
        Login / accounts
        --------------------------- */
     loginSection.style.display = 'flex';
 
     loginBtn.onclick = async ()=>{
       const rawName = usernameInput.value.trim();
       const passwd = passwordInput.value.trim();
       if(!rawName || !passwd) return alert('Vul gebruikersnaam en wachtwoord in.');
 
       const key = keyForName(rawName);
       const existing = await loadUser(key);
       if(!existing) return alert('Account bestaat niet.');
       if(existing.password !== passwd) return alert('Wachtwoord onjuist.');
 
+      const needsLuckyInit = typeof existing.luckyCoins !== 'number' || typeof existing.luckyCoinProgress !== 'number';
       currentUser = existing;
       currentUser.key = key;
+      ensureLuckyFields(currentUser);
       loginSection.style.display='none';
       dashboard.style.display='block';
       renderDashboard();
+      if(needsLuckyInit){
+        saveCurrentUser();
+      }
       bgMusic.play().catch(()=>{});
     };
 
     createAccountBtn.onclick = async ()=>{
       const rawName = usernameInput.value.trim();
       const passwd = passwordInput.value.trim();
       if(!rawName || !passwd) return alert('Vul gebruikersnaam en wachtwoord in.');
 
       const key = keyForName(rawName);
       const existing = await loadUser(key);
       if(existing){
         alert('Account bestaat al.');
         return;
       }
 
       currentUser = {
         key,
         name: rawName,
         password: passwd,
         credits: 1000,
+        luckyCoins: 0,
+        luckyCoinProgress: 0,
         lastDaily: null,
         wins: 0,
         losses: 0,
         gamesPlayed: 0,
         totalEarned: 0,
         bjWins: 0,
         bjLosses: 0,
         bjGames: 0,
         pkWins: 0,
         pkLosses: 0,
         pkGames: 0
       };
       await saveCurrentUser();
       loginSection.style.display='none';
       dashboard.style.display='block';
       renderDashboard();
       bgMusic.play().catch(()=>{});
     };
 
+    function ensureLuckyFields(user){
+      if(!user) return;
+      if(typeof user.luckyCoins !== 'number') user.luckyCoins = 0;
+      if(typeof user.luckyCoinProgress !== 'number') user.luckyCoinProgress = 0;
+    }
+
+    function updateLuckyCoinDisplay(){
+      if(!currentUser) return;
+      ensureLuckyFields(currentUser);
+      luckyCoinsEl.textContent = currentUser.luckyCoins;
+      luckyCoinProgressEl.textContent = currentUser.luckyCoinProgress;
+    }
+
+    function applyLuckyCoinProgress(amount){
+      if(!currentUser || amount <= 0) return;
+      ensureLuckyFields(currentUser);
+      currentUser.luckyCoinProgress += amount;
+      const earned = Math.floor(currentUser.luckyCoinProgress / 500);
+      if(earned > 0){
+        currentUser.luckyCoins += earned;
+        currentUser.luckyCoinProgress = currentUser.luckyCoinProgress % 500;
+      }
+      updateLuckyCoinDisplay();
+    }
+
     function renderDashboard(){
       if(!currentUser) return;
+      ensureLuckyFields(currentUser);
       displayName.textContent = currentUser.name;
       creditsEl.textContent = currentUser.credits;
+      updateLuckyCoinDisplay();
       const bar = document.getElementById('creditsDisplayGlobal');
       if(bar){
         bar.style.display = 'block';
         creditsGlobalSpan.textContent = currentUser.credits;
       }
     }
 
     logoutBtn.onclick = () => {
       currentUser = null;
       dashboard.style.display = 'none';
       blackjackSection.style.display = 'none';
       pokerSection.style.display = 'none';
+      lootBoxSection.style.display = 'none';
       loginSection.style.display = 'flex';
       bgMusic.pause();
       const bar = document.getElementById('creditsDisplayGlobal');
       if(bar) bar.style.display = 'none';
     };
 
     claimDailyBtn.onclick = async ()=>{
       if(!currentUser) return;
       const t = new Date().toDateString();
       if(currentUser.lastDaily !== t){
         currentUser.credits += 100;
         currentUser.lastDaily = t;
         await saveCurrentUser();
         renderDashboard();
         alert('Dagelijkse bonus geclaimd: +100 credits');
       } else {
         alert('Je hebt vandaag al je bonus geclaimd.');
       }
     };
 
     playBlackjackBtn.onclick = ()=>{
       dashboard.style.display='none';
       pokerSection.style.display='none';
+      lootBoxSection.style.display='none';
       blackjackSection.style.display='block';
     };
 
     playPokerBtn.onclick = ()=>{
       dashboard.style.display='none';
       blackjackSection.style.display='none';
+      lootBoxSection.style.display='none';
       pokerSection.style.display='block';
     };
+
+    const lootBoxConfigs = {
+      lucky: { name: 'Lucky Box', cost: 1, startLevel: 1 },
+      deluxe: { name: 'Deluxe Lucky Box', cost: 5, startLevel: 2 },
+      ultra: { name: 'Ultra Deluxe Lucky Box', cost: 10, startLevel: 3 }
+    };
+    const lootBoxRewards = {
+      1: 50,
+      2: 150,
+      3: 500,
+      4: 1000,
+      5: 2500
+    };
+    let currentLootBox = null;
+
+    function updateLootBoxUI(){
+      if(!currentLootBox) return;
+      lootBoxTitle.textContent = currentLootBox.name;
+      lootBoxSubtitle.textContent = `Klik op de box om te upgraden. ${currentLootBox.remainingChances} kansen over.`;
+      lootBoxLevel.textContent = currentLootBox.level;
+      lootBoxCard.className = `lootbox-card lootbox-level-${currentLootBox.level}`;
+      if(currentLootBox.remainingChances === 0){
+        lootBoxCard.classList.add('disabled');
+      }
+      const dots = lootBoxChances.querySelectorAll('.chance-dot');
+      dots.forEach((dot, index)=>{
+        dot.classList.toggle('used', index >= currentLootBox.remainingChances);
+      });
+    }
+
+    function openLootBox(type){
+      if(!currentUser) return alert('Je moet eerst inloggen!');
+      const config = lootBoxConfigs[type];
+      ensureLuckyFields(currentUser);
+      if(currentUser.luckyCoins < config.cost){
+        alert(`Je hebt ${config.cost} Lucky Coins nodig voor ${config.name}.`);
+        return;
+      }
+      currentUser.luckyCoins -= config.cost;
+      currentLootBox = {
+        type,
+        name: config.name,
+        level: config.startLevel,
+        remainingChances: 3
+      };
+      lootBoxReward.textContent = '';
+      lootBoxHint.textContent = 'Klik om te upgraden (12,5% kans per klik).';
+      dashboard.style.display = 'none';
+      blackjackSection.style.display = 'none';
+      pokerSection.style.display = 'none';
+      lootBoxSection.style.display = 'block';
+      updateLuckyCoinDisplay();
+      updateLootBoxUI();
+      saveCurrentUser();
+    }
+
+    openLuckyBoxBtn.onclick = ()=> openLootBox('lucky');
+    openDeluxeBoxBtn.onclick = ()=> openLootBox('deluxe');
+    openUltraBoxBtn.onclick = ()=> openLootBox('ultra');
+
+    lootBoxCard.onclick = ()=>{
+      if(!currentLootBox || currentLootBox.remainingChances === 0) return;
+      currentLootBox.remainingChances -= 1;
+      if(Math.random() < 0.125 && currentLootBox.level < 5){
+        currentLootBox.level += 1;
+      }
+      if(currentLootBox.remainingChances === 0){
+        const reward = lootBoxRewards[currentLootBox.level];
+        currentUser.credits += reward;
+        lootBoxHint.textContent = 'Kist geopend! Je beloning is uitgekeerd.';
+        lootBoxReward.textContent = `Beloning: ${reward} credits (level ${currentLootBox.level}).`;
+        saveCurrentUser().then(renderDashboard);
+      }
+      updateLootBoxUI();
+    };
 const playHorseRaceBtn = document.getElementById("playHorseRaceBtn");
 
 playHorseRaceBtn.onclick = () => {
     dashboard.style.display = "none";
+    lootBoxSection.style.display = "none";
     horseRaceSection.style.display = "block";
 };
 
     backToMenuBtn.onclick = ()=>{
       blackjackSection.style.display='none';
       pokerSection.style.display='none';
+      lootBoxSection.style.display='none';
       dashboard.style.display='block';
     };
 
+    backToMenuFromLoot.onclick = ()=>{
+      lootBoxSection.style.display = 'none';
+      dashboard.style.display = 'block';
+    };
+
     /* ---------------------------
        Music menu
        --------------------------- */
     musicVolume.value = 0.4;
     bgMusic.volume = 0.4;
 
     musicControl.onclick = () => { musicMenu.style.display = (musicMenu.style.display==='block'?'none':'block'); };
     musicVolume.oninput = ()=>{ bgMusic.volume = parseFloat(musicVolume.value); };
     musicTrackSelect.onchange = ()=>{
       const index = parseInt(musicTrackSelect.value);
       const sources = bgMusic.querySelectorAll('source');
       if(sources[index]){
         bgMusic.pause();
         bgMusic.src = sources[index].src;
         bgMusic.load();
         bgMusic.play().catch(()=>{});
       }
     };
     muteBtn.onclick = ()=>{ bgMusic.muted = !bgMusic.muted; muteBtn.textContent = bgMusic.muted ? 'üîá Unmute' : 'üéµ Mute'; };
     closeMusicMenu.onclick = ()=>{ musicMenu.style.display='none'; };
 
     /* ---------------------------
        Blackjack logic
        --------------------------- */
     const suits=['‚ô†','‚ô•','‚ô¶','‚ô£'];
@@ -847,50 +1083,53 @@ playHorseRaceBtn.onclick = () => {
 
       for(let i=0;i<players.length;i++){
         const p=players[i];
         const ps=handValue(p.hand);
         let outcome='lose';
         if(ps>21){
           resultMsg+=`${p.name} verliest (bust).\n`;
           outcome='lose';
         } else if(dealerScore>21 || ps>dealerScore){
           resultMsg+=`${p.name} wint!\n`;
           outcome='win';
         } else if(ps===dealerScore){
           resultMsg+=`${p.name} gelijkspel.\n`;
           outcome='push';
         } else{
           resultMsg+=`${p.name} verliest.\n`;
           outcome='lose';
         }
 
         if(i===0 && currentUser){
           let delta = 0;
           if(outcome==='win') delta = Math.floor(currentBet*1.5);
           else if(outcome==='push') delta = Math.floor(currentBet*1.0);
           else delta = 0;
           currentUser.credits += delta;
+          if(outcome==='win'){
+            applyLuckyCoinProgress(delta);
+          }
           currentUser.gamesPlayed = (currentUser.gamesPlayed||0)+1;
           if(outcome==='win'){ currentUser.wins=(currentUser.wins||0)+1; currentUser.totalEarned=(currentUser.totalEarned||0)+delta; currentUser.bjWins=(currentUser.bjWins||0)+1; }
           else if(outcome==='lose'){ currentUser.losses=(currentUser.losses||0)+1; currentUser.bjLosses=(currentUser.bjLosses||0)+1; }
           currentUser.bjGames=(currentUser.bjGames||0)+1;
         }
       }
 
       alert(resultMsg);
       nextRoundBtn.style.display='inline';
       hitBtn.style.display='none';
       standBtn.style.display='none';
 
       if(currentUser){
         saveCurrentUser().then(renderDashboard);
       }
     }
 
     function startRound(){
       if(!currentUser) return;
       const requestedBet = parseInt(betAmountInput.value)||100;
       if(currentUser.credits < requestedBet){
         alert('Je hebt niet genoeg credits voor deze inzet.');
         return;
       }
       currentBet = requestedBet;
@@ -1119,53 +1358,56 @@ startRaceBtn.onclick = async () => {
     await db.ref("users/" + currentUser.key).update({
         credits: currentUser.credits
     });
     renderDashboard();
 
     // reset horse positions
     horses.forEach(h => h.style.left = "0px");
 
     let finished = false;
     let winner = null;
 
     function raceTick(){
         horses.forEach((horse, index) => {
             if(finished) return;
 
             let move = Math.random() * 25 + 5; // smooth movement
             horse.style.left = (horse.offsetLeft + move) + "px";
 
             if(horse.offsetLeft >= 820){ // finish line
                 finished = true;
                 winner = index + 1;
 
                 if(winner === chosenHorse){
                     const winAmount = bet * 3;
                     currentUser.credits += winAmount;
+                    applyLuckyCoinProgress(winAmount);
 
                     db.ref("users/" + currentUser.key).update({
-                        credits: currentUser.credits
+                        credits: currentUser.credits,
+                        luckyCoins: currentUser.luckyCoins,
+                        luckyCoinProgress: currentUser.luckyCoinProgress
                     });
 
                     alert("üéâ Je paard heeft gewonnen! +" + winAmount + " credits");
 
                 } else {
                     alert("‚ùå Paard " + winner + " won. Je hebt verloren.");
                 }
 
                 renderDashboard();
             }
         });
 
         if(!finished){
             requestAnimationFrame(raceTick);
         }
     }
 
     raceTick();
 };
 
     /* ---------------------------
        Leaderboard popup
        --------------------------- */
     let lbIndex = 0;
     const lbTypes = ['earnings','winrate','bjwinrate','pkwinrate'];
